GPU Memory at before_start:
memory.used [MiB]
613 MiB

Model config: DistilBertConfig {
  "_name_or_path": "distilbert-base-uncased",
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 6,
  "n_layers": 6,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "transformers_version": "4.11.3",
  "vocab_size": 30522
}

Starting training...
GPU Memory at before_training:
memory.used [MiB]
1325 MiB

{'loss': 0.5261, 'learning_rate': 4.8965664320750695e-05, 'epoch': 0.06}
{'loss': 0.3893, 'learning_rate': 4.791000213265089e-05, 'epoch': 0.13}
{'loss': 0.3466, 'learning_rate': 4.684367669012583e-05, 'epoch': 0.19}
{'loss': 0.3222, 'learning_rate': 4.577735124760077e-05, 'epoch': 0.26}
{'loss': 0.3398, 'learning_rate': 4.4711025805075713e-05, 'epoch': 0.32}
{'loss': 0.3417, 'learning_rate': 4.364470036255065e-05, 'epoch': 0.38}
{'loss': 0.3205, 'learning_rate': 4.257837492002559e-05, 'epoch': 0.45}
{'loss': 0.33, 'learning_rate': 4.151204947750054e-05, 'epoch': 0.51}
{'loss': 0.2966, 'learning_rate': 4.044572403497547e-05, 'epoch': 0.58}
{'loss': 0.3112, 'learning_rate': 3.937939859245042e-05, 'epoch': 0.64}
{'loss': 0.2771, 'learning_rate': 3.831307314992536e-05, 'epoch': 0.7}
{'loss': 0.2554, 'learning_rate': 3.72467477074003e-05, 'epoch': 0.77}
{'loss': 0.2729, 'learning_rate': 3.618042226487524e-05, 'epoch': 0.83}
{'loss': 0.2671, 'learning_rate': 3.511409682235018e-05, 'epoch': 0.9}
{'loss': 0.2852, 'learning_rate': 3.404777137982512e-05, 'epoch': 0.96}
{'eval_loss': 0.2633356750011444, 'eval_accuracy': 0.89008, 'eval_f1': 0.8897489115714055, 'eval_runtime': 93.5284, 'eval_samples_per_second': 267.298, 'eval_steps_per_second': 16.712, 'epoch': 1.0}
{'loss': 0.2524, 'learning_rate': 3.298144593730007e-05, 'epoch': 1.02}
{'loss': 0.1971, 'learning_rate': 3.191512049477501e-05, 'epoch': 1.09}
{'loss': 0.1994, 'learning_rate': 3.084879505224995e-05, 'epoch': 1.15}
{'loss': 0.2042, 'learning_rate': 2.978246960972489e-05, 'epoch': 1.22}
{'loss': 0.1944, 'learning_rate': 2.8716144167199833e-05, 'epoch': 1.28}
{'loss': 0.1975, 'learning_rate': 2.764981872467477e-05, 'epoch': 1.34}
{'loss': 0.1983, 'learning_rate': 2.6583493282149712e-05, 'epoch': 1.41}
{'loss': 0.1931, 'learning_rate': 2.5517167839624655e-05, 'epoch': 1.47}
{'loss': 0.162, 'learning_rate': 2.4450842397099598e-05, 'epoch': 1.54}
{'loss': 0.1795, 'learning_rate': 2.3384516954574537e-05, 'epoch': 1.6}
{'loss': 0.1957, 'learning_rate': 2.2318191512049477e-05, 'epoch': 1.66}
{'loss': 0.1808, 'learning_rate': 2.125186606952442e-05, 'epoch': 1.73}
{'loss': 0.2033, 'learning_rate': 2.0185540626999362e-05, 'epoch': 1.79}
{'loss': 0.1733, 'learning_rate': 1.9119215184474302e-05, 'epoch': 1.86}
{'loss': 0.1677, 'learning_rate': 1.8052889741949245e-05, 'epoch': 1.92}
{'loss': 0.1516, 'learning_rate': 1.6986564299424184e-05, 'epoch': 1.98}
{'eval_loss': 0.2893277704715729, 'eval_accuracy': 0.91356, 'eval_f1': 0.9135489219513763, 'eval_runtime': 93.3965, 'eval_samples_per_second': 267.676, 'eval_steps_per_second': 16.735, 'epoch': 2.0}
{'loss': 0.1305, 'learning_rate': 1.5920238856899124e-05, 'epoch': 2.05}
{'loss': 0.0995, 'learning_rate': 1.4853913414374068e-05, 'epoch': 2.11}
{'loss': 0.0834, 'learning_rate': 1.3787587971849008e-05, 'epoch': 2.18}
{'loss': 0.1053, 'learning_rate': 1.2721262529323949e-05, 'epoch': 2.24}
{'loss': 0.1219, 'learning_rate': 1.1654937086798892e-05, 'epoch': 2.3}
{'loss': 0.1063, 'learning_rate': 1.0599274898699083e-05, 'epoch': 2.37}
{'loss': 0.1162, 'learning_rate': 9.532949456174024e-06, 'epoch': 2.43}
{'loss': 0.0866, 'learning_rate': 8.466624013648965e-06, 'epoch': 2.5}
{'loss': 0.1155, 'learning_rate': 7.4002985711239075e-06, 'epoch': 2.56}
{'loss': 0.0873, 'learning_rate': 6.333973128598848e-06, 'epoch': 2.62}
{'loss': 0.114, 'learning_rate': 5.26764768607379e-06, 'epoch': 2.69}
{'loss': 0.0895, 'learning_rate': 4.201322243548731e-06, 'epoch': 2.75}
{'loss': 0.0635, 'learning_rate': 3.1349968010236727e-06, 'epoch': 2.82}
{'loss': 0.0823, 'learning_rate': 2.068671358498614e-06, 'epoch': 2.88}
{'loss': 0.0945, 'learning_rate': 1.0023459159735552e-06, 'epoch': 2.94}
{'eval_loss': 0.3501187562942505, 'eval_accuracy': 0.9166, 'eval_f1': 0.9165999411529183, 'eval_runtime': 93.3646, 'eval_samples_per_second': 267.767, 'eval_steps_per_second': 16.741, 'epoch': 3.0}
{'train_runtime': 531.6949, 'train_samples_per_second': 141.058, 'train_steps_per_second': 8.819, 'train_loss': 0.20282746337578225, 'epoch': 3.0}
Training finished. Training time: 532.58 seconds.
GPU Memory at after_training:
memory.used [MiB]
4897 MiB

Evaluating the model...
Accuracy: 0.8901
F1-score: 0.8897
Inference time: 0.41 ms/example
GPU Memory at after_inference:
memory.used [MiB]
2147 MiB

GPU memory consumption: 2.10 GB

Results for the IMDb table:
| Model                     | Accuracy | F1-score | Inference Time (ms) | Memory (GB) | Training Time (s) |
|---------------------------|----------|----------|---------------------|-------------|-------------------|
| DistilBERT-6-heads        | 0.8901   | 0.8897   | 0.41               | 2.10         | 532.58         |

Starting fine-tuning on Yelp Polarity...
{'loss': 0.2763, 'learning_rate': 1.9943428571428575e-05, 'epoch': 0.0}
{'loss': 0.2212, 'learning_rate': 1.9886285714285715e-05, 'epoch': 0.01}
{'loss': 0.2082, 'learning_rate': 1.982971428571429e-05, 'epoch': 0.01}
{'loss': 0.1747, 'learning_rate': 1.977257142857143e-05, 'epoch': 0.01}
{'loss': 0.2277, 'learning_rate': 1.9716000000000002e-05, 'epoch': 0.01}
{'loss': 0.194, 'learning_rate': 1.9658857142857143e-05, 'epoch': 0.02}
{'loss': 0.207, 'learning_rate': 1.9601714285714287e-05, 'epoch': 0.02}
{'loss': 0.1907, 'learning_rate': 1.954457142857143e-05, 'epoch': 0.02}
{'loss': 0.2063, 'learning_rate': 1.948742857142857e-05, 'epoch': 0.03}
{'loss': 0.1905, 'learning_rate': 1.9430285714285715e-05, 'epoch': 0.03}
{'loss': 0.158, 'learning_rate': 1.937314285714286e-05, 'epoch': 0.03}
{'loss': 0.1821, 'learning_rate': 1.9316571428571432e-05, 'epoch': 0.03}
{'loss': 0.1887, 'learning_rate': 1.9259428571428573e-05, 'epoch': 0.04}
{'loss': 0.1581, 'learning_rate': 1.9202285714285716e-05, 'epoch': 0.04}
{'loss': 0.1735, 'learning_rate': 1.9145142857142857e-05, 'epoch': 0.04}
{'loss': 0.1587, 'learning_rate': 1.9088e-05, 'epoch': 0.05}
{'loss': 0.1715, 'learning_rate': 1.9030857142857145e-05, 'epoch': 0.05}
{'loss': 0.164, 'learning_rate': 1.8973714285714285e-05, 'epoch': 0.05}
{'loss': 0.1763, 'learning_rate': 1.891657142857143e-05, 'epoch': 0.05}
{'loss': 0.1822, 'learning_rate': 1.8859428571428573e-05, 'epoch': 0.06}
{'loss': 0.1943, 'learning_rate': 1.8802285714285714e-05, 'epoch': 0.06}
{'loss': 0.1493, 'learning_rate': 1.874514285714286e-05, 'epoch': 0.06}
{'loss': 0.156, 'learning_rate': 1.8688e-05, 'epoch': 0.07}
{'loss': 0.1634, 'learning_rate': 1.8630857142857145e-05, 'epoch': 0.07}
{'loss': 0.1426, 'learning_rate': 1.857371428571429e-05, 'epoch': 0.07}
{'loss': 0.1632, 'learning_rate': 1.851657142857143e-05, 'epoch': 0.07}
{'loss': 0.1432, 'learning_rate': 1.8459428571428573e-05, 'epoch': 0.08}
{'loss': 0.1627, 'learning_rate': 1.8402285714285714e-05, 'epoch': 0.08}
{'loss': 0.1441, 'learning_rate': 1.8345142857142858e-05, 'epoch': 0.08}
{'loss': 0.146, 'learning_rate': 1.8288000000000002e-05, 'epoch': 0.09}
{'loss': 0.149, 'learning_rate': 1.8230857142857142e-05, 'epoch': 0.09}
{'loss': 0.1437, 'learning_rate': 1.817371428571429e-05, 'epoch': 0.09}
{'loss': 0.1422, 'learning_rate': 1.811657142857143e-05, 'epoch': 0.09}
{'loss': 0.1482, 'learning_rate': 1.805942857142857e-05, 'epoch': 0.1}
{'loss': 0.1485, 'learning_rate': 1.8002285714285718e-05, 'epoch': 0.1}
{'loss': 0.1677, 'learning_rate': 1.794514285714286e-05, 'epoch': 0.1}
{'loss': 0.1808, 'learning_rate': 1.7888000000000002e-05, 'epoch': 0.11}
{'loss': 0.1499, 'learning_rate': 1.7830857142857146e-05, 'epoch': 0.11}
{'loss': 0.1511, 'learning_rate': 1.7773714285714287e-05, 'epoch': 0.11}
{'loss': 0.1202, 'learning_rate': 1.771657142857143e-05, 'epoch': 0.11}
{'loss': 0.1476, 'learning_rate': 1.765942857142857e-05, 'epoch': 0.12}
{'loss': 0.1524, 'learning_rate': 1.7602285714285715e-05, 'epoch': 0.12}
{'loss': 0.1687, 'learning_rate': 1.754514285714286e-05, 'epoch': 0.12}
{'loss': 0.1463, 'learning_rate': 1.7488e-05, 'epoch': 0.13}
{'loss': 0.1464, 'learning_rate': 1.7430857142857147e-05, 'epoch': 0.13}
{'loss': 0.1352, 'learning_rate': 1.7373714285714287e-05, 'epoch': 0.13}
{'loss': 0.1578, 'learning_rate': 1.731657142857143e-05, 'epoch': 0.13}
{'loss': 0.1536, 'learning_rate': 1.7259428571428575e-05, 'epoch': 0.14}
{'loss': 0.1011, 'learning_rate': 1.7202285714285715e-05, 'epoch': 0.14}
{'loss': 0.142, 'learning_rate': 1.714514285714286e-05, 'epoch': 0.14}
{'loss': 0.1506, 'learning_rate': 1.7088000000000003e-05, 'epoch': 0.15}
{'loss': 0.168, 'learning_rate': 1.7031428571428573e-05, 'epoch': 0.15}
{'loss': 0.1496, 'learning_rate': 1.6974285714285717e-05, 'epoch': 0.15}
{'loss': 0.1552, 'learning_rate': 1.6917142857142857e-05, 'epoch': 0.15}
{'loss': 0.1422, 'learning_rate': 1.686e-05, 'epoch': 0.16}
{'loss': 0.1483, 'learning_rate': 1.6802857142857145e-05, 'epoch': 0.16}
{'loss': 0.1533, 'learning_rate': 1.674571428571429e-05, 'epoch': 0.16}
{'loss': 0.1447, 'learning_rate': 1.668857142857143e-05, 'epoch': 0.17}
{'loss': 0.1637, 'learning_rate': 1.6631428571428573e-05, 'epoch': 0.17}
{'loss': 0.1425, 'learning_rate': 1.6574285714285717e-05, 'epoch': 0.17}
{'loss': 0.1315, 'learning_rate': 1.6517714285714287e-05, 'epoch': 0.17}
{'loss': 0.1435, 'learning_rate': 1.646057142857143e-05, 'epoch': 0.18}
{'loss': 0.1372, 'learning_rate': 1.640342857142857e-05, 'epoch': 0.18}
{'loss': 0.1399, 'learning_rate': 1.6346285714285715e-05, 'epoch': 0.18}
{'loss': 0.1525, 'learning_rate': 1.628914285714286e-05, 'epoch': 0.19}
{'loss': 0.1292, 'learning_rate': 1.6232e-05, 'epoch': 0.19}
{'loss': 0.141, 'learning_rate': 1.6174857142857144e-05, 'epoch': 0.19}
{'loss': 0.1485, 'learning_rate': 1.6117714285714288e-05, 'epoch': 0.19}
{'loss': 0.1361, 'learning_rate': 1.606057142857143e-05, 'epoch': 0.2}
{'loss': 0.1156, 'learning_rate': 1.6003428571428572e-05, 'epoch': 0.2}
{'loss': 0.1291, 'learning_rate': 1.5946285714285716e-05, 'epoch': 0.2}
{'loss': 0.1597, 'learning_rate': 1.588914285714286e-05, 'epoch': 0.21}
{'loss': 0.1293, 'learning_rate': 1.5832e-05, 'epoch': 0.21}
{'loss': 0.1224, 'learning_rate': 1.5774857142857144e-05, 'epoch': 0.21}
{'loss': 0.149, 'learning_rate': 1.5717714285714288e-05, 'epoch': 0.21}
{'loss': 0.1457, 'learning_rate': 1.566057142857143e-05, 'epoch': 0.22}
{'loss': 0.1407, 'learning_rate': 1.5603428571428572e-05, 'epoch': 0.22}
{'loss': 0.1239, 'learning_rate': 1.5546285714285716e-05, 'epoch': 0.22}
{'loss': 0.1352, 'learning_rate': 1.5489142857142857e-05, 'epoch': 0.23}
{'loss': 0.1265, 'learning_rate': 1.5432e-05, 'epoch': 0.23}
{'loss': 0.1247, 'learning_rate': 1.5374857142857145e-05, 'epoch': 0.23}
{'loss': 0.1667, 'learning_rate': 1.531771428571429e-05, 'epoch': 0.23}
{'loss': 0.1274, 'learning_rate': 1.526057142857143e-05, 'epoch': 0.24}
{'loss': 0.1272, 'learning_rate': 1.5203428571428573e-05, 'epoch': 0.24}
{'loss': 0.1564, 'learning_rate': 1.5146285714285715e-05, 'epoch': 0.24}
{'loss': 0.1137, 'learning_rate': 1.5089142857142857e-05, 'epoch': 0.25}
{'loss': 0.1413, 'learning_rate': 1.5032000000000003e-05, 'epoch': 0.25}
{'loss': 0.147, 'learning_rate': 1.4975428571428573e-05, 'epoch': 0.25}
{'loss': 0.1302, 'learning_rate': 1.4918285714285717e-05, 'epoch': 0.25}
{'loss': 0.1161, 'learning_rate': 1.4861142857142859e-05, 'epoch': 0.26}
{'loss': 0.1445, 'learning_rate': 1.4804000000000001e-05, 'epoch': 0.26}
{'loss': 0.1461, 'learning_rate': 1.4746857142857145e-05, 'epoch': 0.26}
{'loss': 0.1083, 'learning_rate': 1.4689714285714287e-05, 'epoch': 0.27}
{'loss': 0.1319, 'learning_rate': 1.463257142857143e-05, 'epoch': 0.27}
{'loss': 0.1317, 'learning_rate': 1.4575428571428573e-05, 'epoch': 0.27}
{'loss': 0.1126, 'learning_rate': 1.4518285714285715e-05, 'epoch': 0.27}
{'loss': 0.1252, 'learning_rate': 1.4461142857142857e-05, 'epoch': 0.28}
{'loss': 0.1344, 'learning_rate': 1.4404e-05, 'epoch': 0.28}
{'loss': 0.1186, 'learning_rate': 1.4346857142857145e-05, 'epoch': 0.28}
{'loss': 0.1223, 'learning_rate': 1.4289714285714287e-05, 'epoch': 0.29}
{'loss': 0.1487, 'learning_rate': 1.423257142857143e-05, 'epoch': 0.29}
{'loss': 0.1447, 'learning_rate': 1.4175428571428574e-05, 'epoch': 0.29}
{'loss': 0.1073, 'learning_rate': 1.4118285714285716e-05, 'epoch': 0.29}
{'loss': 0.1349, 'learning_rate': 1.4061142857142858e-05, 'epoch': 0.3}
{'loss': 0.1319, 'learning_rate': 1.4004000000000002e-05, 'epoch': 0.3}
{'loss': 0.132, 'learning_rate': 1.3946857142857144e-05, 'epoch': 0.3}
{'loss': 0.1413, 'learning_rate': 1.3889714285714286e-05, 'epoch': 0.31}
{'loss': 0.1247, 'learning_rate': 1.383257142857143e-05, 'epoch': 0.31}
{'loss': 0.1218, 'learning_rate': 1.3775428571428572e-05, 'epoch': 0.31}
{'loss': 0.1337, 'learning_rate': 1.3718285714285714e-05, 'epoch': 0.31}
{'loss': 0.1364, 'learning_rate': 1.3661142857142857e-05, 'epoch': 0.32}
{'loss': 0.1223, 'learning_rate': 1.3604000000000002e-05, 'epoch': 0.32}
{'loss': 0.1304, 'learning_rate': 1.3546857142857144e-05, 'epoch': 0.32}
{'loss': 0.1294, 'learning_rate': 1.3489714285714287e-05, 'epoch': 0.33}
{'loss': 0.1401, 'learning_rate': 1.343257142857143e-05, 'epoch': 0.33}
{'loss': 0.1051, 'learning_rate': 1.3375428571428573e-05, 'epoch': 0.33}
{'loss': 0.1203, 'learning_rate': 1.3318285714285715e-05, 'epoch': 0.33}
{'loss': 0.0996, 'learning_rate': 1.3261142857142859e-05, 'epoch': 0.34}
{'loss': 0.1288, 'learning_rate': 1.3204000000000001e-05, 'epoch': 0.34}
{'loss': 0.1329, 'learning_rate': 1.3146857142857143e-05, 'epoch': 0.34}
{'loss': 0.1253, 'learning_rate': 1.3089714285714287e-05, 'epoch': 0.35}
{'loss': 0.1424, 'learning_rate': 1.303257142857143e-05, 'epoch': 0.35}
{'loss': 0.1145, 'learning_rate': 1.2975428571428571e-05, 'epoch': 0.35}
{'loss': 0.1184, 'learning_rate': 1.2918285714285714e-05, 'epoch': 0.35}
{'loss': 0.0966, 'learning_rate': 1.286114285714286e-05, 'epoch': 0.36}
{'loss': 0.1295, 'learning_rate': 1.2804000000000001e-05, 'epoch': 0.36}
{'loss': 0.122, 'learning_rate': 1.2746857142857144e-05, 'epoch': 0.36}
{'loss': 0.1201, 'learning_rate': 1.2689714285714287e-05, 'epoch': 0.37}
{'loss': 0.1384, 'learning_rate': 1.2633142857142857e-05, 'epoch': 0.37}
{'loss': 0.1254, 'learning_rate': 1.2576000000000001e-05, 'epoch': 0.37}
{'loss': 0.1139, 'learning_rate': 1.2518857142857143e-05, 'epoch': 0.37}
{'loss': 0.1258, 'learning_rate': 1.2462285714285715e-05, 'epoch': 0.38}
{'loss': 0.1045, 'learning_rate': 1.2405142857142857e-05, 'epoch': 0.38}
{'loss': 0.1495, 'learning_rate': 1.2348e-05, 'epoch': 0.38}
{'loss': 0.1383, 'learning_rate': 1.2290857142857145e-05, 'epoch': 0.39}
{'loss': 0.1325, 'learning_rate': 1.2233714285714287e-05, 'epoch': 0.39}
{'loss': 0.1307, 'learning_rate': 1.217657142857143e-05, 'epoch': 0.39}
{'loss': 0.1108, 'learning_rate': 1.2119428571428573e-05, 'epoch': 0.39}
{'loss': 0.1105, 'learning_rate': 1.2062285714285715e-05, 'epoch': 0.4}
{'loss': 0.131, 'learning_rate': 1.2005142857142858e-05, 'epoch': 0.4}
{'loss': 0.1081, 'learning_rate': 1.1948000000000001e-05, 'epoch': 0.4}
{'loss': 0.1397, 'learning_rate': 1.1890857142857144e-05, 'epoch': 0.41}
{'loss': 0.1191, 'learning_rate': 1.1833714285714286e-05, 'epoch': 0.41}
{'loss': 0.1441, 'learning_rate': 1.177657142857143e-05, 'epoch': 0.41}
{'loss': 0.1214, 'learning_rate': 1.1719428571428572e-05, 'epoch': 0.41}
{'loss': 0.1383, 'learning_rate': 1.1662285714285714e-05, 'epoch': 0.42}
{'loss': 0.1115, 'learning_rate': 1.1605142857142856e-05, 'epoch': 0.42}
{'loss': 0.1234, 'learning_rate': 1.1548000000000002e-05, 'epoch': 0.42}
{'loss': 0.1064, 'learning_rate': 1.1490857142857144e-05, 'epoch': 0.43}
{'loss': 0.134, 'learning_rate': 1.1433714285714286e-05, 'epoch': 0.43}
{'loss': 0.1271, 'learning_rate': 1.137657142857143e-05, 'epoch': 0.43}
{'loss': 0.1332, 'learning_rate': 1.1319428571428572e-05, 'epoch': 0.43}
{'loss': 0.1307, 'learning_rate': 1.1262285714285715e-05, 'epoch': 0.44}
{'loss': 0.1092, 'learning_rate': 1.1205142857142858e-05, 'epoch': 0.44}
{'loss': 0.1203, 'learning_rate': 1.1148e-05, 'epoch': 0.44}
{'loss': 0.1219, 'learning_rate': 1.1090857142857143e-05, 'epoch': 0.45}
{'loss': 0.1043, 'learning_rate': 1.1033714285714288e-05, 'epoch': 0.45}
{'loss': 0.1147, 'learning_rate': 1.0976571428571429e-05, 'epoch': 0.45}
{'loss': 0.141, 'learning_rate': 1.0919428571428571e-05, 'epoch': 0.45}
{'loss': 0.0996, 'learning_rate': 1.0862285714285713e-05, 'epoch': 0.46}
{'loss': 0.1234, 'learning_rate': 1.0805142857142859e-05, 'epoch': 0.46}
{'loss': 0.1057, 'learning_rate': 1.0748000000000001e-05, 'epoch': 0.46}
{'loss': 0.1084, 'learning_rate': 1.0690857142857143e-05, 'epoch': 0.47}
{'loss': 0.1175, 'learning_rate': 1.0633714285714287e-05, 'epoch': 0.47}
{'loss': 0.1085, 'learning_rate': 1.057657142857143e-05, 'epoch': 0.47}
{'loss': 0.1121, 'learning_rate': 1.0519428571428572e-05, 'epoch': 0.47}
{'loss': 0.1116, 'learning_rate': 1.0462285714285715e-05, 'epoch': 0.48}
{'loss': 0.116, 'learning_rate': 1.0405142857142858e-05, 'epoch': 0.48}
{'loss': 0.1077, 'learning_rate': 1.0348e-05, 'epoch': 0.48}
{'loss': 0.1323, 'learning_rate': 1.0290857142857145e-05, 'epoch': 0.49}
{'loss': 0.1117, 'learning_rate': 1.0233714285714288e-05, 'epoch': 0.49}
{'loss': 0.1025, 'learning_rate': 1.017657142857143e-05, 'epoch': 0.49}
{'loss': 0.1015, 'learning_rate': 1.011942857142857e-05, 'epoch': 0.49}
{'loss': 0.1086, 'learning_rate': 1.0062857142857144e-05, 'epoch': 0.5}
{'loss': 0.1307, 'learning_rate': 1.0005714285714287e-05, 'epoch': 0.5}
{'loss': 0.1249, 'learning_rate': 9.94857142857143e-06, 'epoch': 0.5}
{'loss': 0.0979, 'learning_rate': 9.891428571428572e-06, 'epoch': 0.51}
{'loss': 0.1256, 'learning_rate': 9.834285714285716e-06, 'epoch': 0.51}
{'loss': 0.129, 'learning_rate': 9.777142857142858e-06, 'epoch': 0.51}
{'loss': 0.1067, 'learning_rate': 9.72e-06, 'epoch': 0.51}
{'loss': 0.1113, 'learning_rate': 9.662857142857144e-06, 'epoch': 0.52}
{'loss': 0.1065, 'learning_rate': 9.605714285714286e-06, 'epoch': 0.52}
{'loss': 0.0967, 'learning_rate': 9.54857142857143e-06, 'epoch': 0.52}
{'loss': 0.1177, 'learning_rate': 9.491428571428572e-06, 'epoch': 0.53}
{'loss': 0.1289, 'learning_rate': 9.434285714285714e-06, 'epoch': 0.53}
{'loss': 0.1145, 'learning_rate': 9.377142857142858e-06, 'epoch': 0.53}
{'loss': 0.1039, 'learning_rate': 9.32e-06, 'epoch': 0.53}
{'loss': 0.0997, 'learning_rate': 9.262857142857143e-06, 'epoch': 0.54}
{'loss': 0.114, 'learning_rate': 9.205714285714287e-06, 'epoch': 0.54}
{'loss': 0.1264, 'learning_rate': 9.148571428571429e-06, 'epoch': 0.54}
{'loss': 0.1013, 'learning_rate': 9.091428571428573e-06, 'epoch': 0.55}
{'loss': 0.0991, 'learning_rate': 9.034285714285715e-06, 'epoch': 0.55}
{'loss': 0.121, 'learning_rate': 8.977142857142857e-06, 'epoch': 0.55}
{'loss': 0.1086, 'learning_rate': 8.920000000000001e-06, 'epoch': 0.55}
{'loss': 0.1353, 'learning_rate': 8.862857142857143e-06, 'epoch': 0.56}
{'loss': 0.1137, 'learning_rate': 8.805714285714287e-06, 'epoch': 0.56}
{'loss': 0.1213, 'learning_rate': 8.74857142857143e-06, 'epoch': 0.56}
{'loss': 0.0862, 'learning_rate': 8.691428571428571e-06, 'epoch': 0.57}
{'loss': 0.1235, 'learning_rate': 8.634285714285715e-06, 'epoch': 0.57}
{'loss': 0.0978, 'learning_rate': 8.577142857142858e-06, 'epoch': 0.57}
{'loss': 0.1165, 'learning_rate': 8.52e-06, 'epoch': 0.57}
{'loss': 0.1186, 'learning_rate': 8.462857142857144e-06, 'epoch': 0.58}
{'loss': 0.1106, 'learning_rate': 8.405714285714286e-06, 'epoch': 0.58}
{'loss': 0.1303, 'learning_rate': 8.34857142857143e-06, 'epoch': 0.58}
{'loss': 0.1307, 'learning_rate': 8.291428571428572e-06, 'epoch': 0.59}
{'loss': 0.1355, 'learning_rate': 8.234285714285714e-06, 'epoch': 0.59}
{'loss': 0.1194, 'learning_rate': 8.177142857142858e-06, 'epoch': 0.59}
{'loss': 0.0992, 'learning_rate': 8.120000000000002e-06, 'epoch': 0.59}
{'loss': 0.1172, 'learning_rate': 8.062857142857144e-06, 'epoch': 0.6}
{'loss': 0.1201, 'learning_rate': 8.005714285714286e-06, 'epoch': 0.6}
{'loss': 0.1072, 'learning_rate': 7.948571428571428e-06, 'epoch': 0.6}
{'loss': 0.1345, 'learning_rate': 7.891428571428572e-06, 'epoch': 0.61}
{'loss': 0.1102, 'learning_rate': 7.834285714285715e-06, 'epoch': 0.61}
{'loss': 0.1151, 'learning_rate': 7.777714285714286e-06, 'epoch': 0.61}
{'loss': 0.0994, 'learning_rate': 7.72057142857143e-06, 'epoch': 0.61}
{'loss': 0.1026, 'learning_rate': 7.663428571428572e-06, 'epoch': 0.62}
{'loss': 0.1042, 'learning_rate': 7.606285714285715e-06, 'epoch': 0.62}
{'loss': 0.1121, 'learning_rate': 7.549142857142858e-06, 'epoch': 0.62}
{'loss': 0.1035, 'learning_rate': 7.4920000000000004e-06, 'epoch': 0.63}
{'loss': 0.1261, 'learning_rate': 7.4348571428571435e-06, 'epoch': 0.63}
{'loss': 0.1436, 'learning_rate': 7.377714285714286e-06, 'epoch': 0.63}
{'loss': 0.1221, 'learning_rate': 7.320571428571429e-06, 'epoch': 0.63}
{'loss': 0.0884, 'learning_rate': 7.263428571428573e-06, 'epoch': 0.64}
{'loss': 0.1177, 'learning_rate': 7.206285714285715e-06, 'epoch': 0.64}
{'loss': 0.1046, 'learning_rate': 7.149142857142858e-06, 'epoch': 0.64}
{'loss': 0.1059, 'learning_rate': 7.092000000000001e-06, 'epoch': 0.65}
{'loss': 0.11, 'learning_rate': 7.034857142857143e-06, 'epoch': 0.65}
{'loss': 0.1246, 'learning_rate': 6.977714285714287e-06, 'epoch': 0.65}
{'loss': 0.092, 'learning_rate': 6.920571428571428e-06, 'epoch': 0.65}
{'loss': 0.1181, 'learning_rate': 6.863428571428572e-06, 'epoch': 0.66}
{'loss': 0.1199, 'learning_rate': 6.806285714285715e-06, 'epoch': 0.66}
{'loss': 0.0996, 'learning_rate': 6.7491428571428574e-06, 'epoch': 0.66}
{'loss': 0.1246, 'learning_rate': 6.6920000000000005e-06, 'epoch': 0.67}
{'loss': 0.1056, 'learning_rate': 6.635428571428571e-06, 'epoch': 0.67}
{'loss': 0.0995, 'learning_rate': 6.578285714285715e-06, 'epoch': 0.67}
{'loss': 0.1095, 'learning_rate': 6.521142857142858e-06, 'epoch': 0.67}
{'loss': 0.094, 'learning_rate': 6.464e-06, 'epoch': 0.68}
{'loss': 0.106, 'learning_rate': 6.406857142857143e-06, 'epoch': 0.68}
{'loss': 0.1217, 'learning_rate': 6.3497142857142855e-06, 'epoch': 0.68}
{'loss': 0.1301, 'learning_rate': 6.292571428571429e-06, 'epoch': 0.69}
{'loss': 0.0779, 'learning_rate': 6.2354285714285724e-06, 'epoch': 0.69}
{'loss': 0.1142, 'learning_rate': 6.178285714285715e-06, 'epoch': 0.69}
{'loss': 0.1118, 'learning_rate': 6.121142857142858e-06, 'epoch': 0.69}
{'loss': 0.1011, 'learning_rate': 6.064000000000001e-06, 'epoch': 0.7}
{'loss': 0.1216, 'learning_rate': 6.006857142857143e-06, 'epoch': 0.7}
{'loss': 0.1131, 'learning_rate': 5.949714285714287e-06, 'epoch': 0.7}
{'loss': 0.1298, 'learning_rate': 5.892571428571429e-06, 'epoch': 0.71}
{'loss': 0.0877, 'learning_rate': 5.8360000000000005e-06, 'epoch': 0.71}
{'loss': 0.1394, 'learning_rate': 5.778857142857144e-06, 'epoch': 0.71}
{'loss': 0.1344, 'learning_rate': 5.721714285714286e-06, 'epoch': 0.71}
{'loss': 0.0985, 'learning_rate': 5.66457142857143e-06, 'epoch': 0.72}
{'loss': 0.098, 'learning_rate': 5.607428571428572e-06, 'epoch': 0.72}
{'loss': 0.1104, 'learning_rate': 5.550285714285715e-06, 'epoch': 0.72}
{'loss': 0.1111, 'learning_rate': 5.493142857142858e-06, 'epoch': 0.73}
{'loss': 0.1324, 'learning_rate': 5.436e-06, 'epoch': 0.73}
{'loss': 0.0981, 'learning_rate': 5.378857142857143e-06, 'epoch': 0.73}
{'loss': 0.1117, 'learning_rate': 5.321714285714285e-06, 'epoch': 0.73}
{'loss': 0.0991, 'learning_rate': 5.264571428571429e-06, 'epoch': 0.74}
{'loss': 0.1026, 'learning_rate': 5.207428571428572e-06, 'epoch': 0.74}
{'loss': 0.0881, 'learning_rate': 5.1502857142857145e-06, 'epoch': 0.74}
{'loss': 0.0926, 'learning_rate': 5.0931428571428575e-06, 'epoch': 0.75}
{'loss': 0.1076, 'learning_rate': 5.0360000000000006e-06, 'epoch': 0.75}
{'loss': 0.1128, 'learning_rate': 4.978857142857143e-06, 'epoch': 0.75}
{'loss': 0.1082, 'learning_rate': 4.921714285714287e-06, 'epoch': 0.75}
{'loss': 0.1115, 'learning_rate': 4.864571428571429e-06, 'epoch': 0.76}
{'loss': 0.0971, 'learning_rate': 4.807428571428572e-06, 'epoch': 0.76}
{'loss': 0.1019, 'learning_rate': 4.750285714285714e-06, 'epoch': 0.76}
{'loss': 0.1045, 'learning_rate': 4.693142857142858e-06, 'epoch': 0.77}
{'loss': 0.0828, 'learning_rate': 4.636e-06, 'epoch': 0.77}
{'loss': 0.1121, 'learning_rate': 4.578857142857143e-06, 'epoch': 0.77}
{'loss': 0.0906, 'learning_rate': 4.521714285714286e-06, 'epoch': 0.77}
{'loss': 0.1326, 'learning_rate': 4.4645714285714284e-06, 'epoch': 0.78}
{'loss': 0.0983, 'learning_rate': 4.407428571428572e-06, 'epoch': 0.78}
{'loss': 0.1248, 'learning_rate': 4.3502857142857145e-06, 'epoch': 0.78}
{'loss': 0.0844, 'learning_rate': 4.2931428571428576e-06, 'epoch': 0.79}
{'loss': 0.1206, 'learning_rate': 4.236e-06, 'epoch': 0.79}
{'loss': 0.1075, 'learning_rate': 4.178857142857144e-06, 'epoch': 0.79}
{'loss': 0.1107, 'learning_rate': 4.121714285714286e-06, 'epoch': 0.79}
{'loss': 0.108, 'learning_rate': 4.064571428571429e-06, 'epoch': 0.8}
{'loss': 0.103, 'learning_rate': 4.007428571428572e-06, 'epoch': 0.8}
{'loss': 0.1074, 'learning_rate': 3.950285714285715e-06, 'epoch': 0.8}
{'loss': 0.1151, 'learning_rate': 3.893142857142857e-06, 'epoch': 0.81}
{'loss': 0.1147, 'learning_rate': 3.836e-06, 'epoch': 0.81}
{'loss': 0.09, 'learning_rate': 3.778857142857143e-06, 'epoch': 0.81}
{'loss': 0.1081, 'learning_rate': 3.7217142857142863e-06, 'epoch': 0.81}
{'loss': 0.1158, 'learning_rate': 3.664571428571429e-06, 'epoch': 0.82}
{'loss': 0.0904, 'learning_rate': 3.6074285714285715e-06, 'epoch': 0.82}
{'loss': 0.1069, 'learning_rate': 3.5502857142857146e-06, 'epoch': 0.82}
{'loss': 0.0968, 'learning_rate': 3.4937142857142857e-06, 'epoch': 0.83}
{'loss': 0.1156, 'learning_rate': 3.436571428571429e-06, 'epoch': 0.83}
{'loss': 0.1121, 'learning_rate': 3.3794285714285718e-06, 'epoch': 0.83}
{'loss': 0.1172, 'learning_rate': 3.3228571428571433e-06, 'epoch': 0.83}
{'loss': 0.1032, 'learning_rate': 3.265714285714286e-06, 'epoch': 0.84}
{'loss': 0.0727, 'learning_rate': 3.2085714285714285e-06, 'epoch': 0.84}
{'loss': 0.1183, 'learning_rate': 3.151428571428572e-06, 'epoch': 0.84}
{'loss': 0.0991, 'learning_rate': 3.0942857142857146e-06, 'epoch': 0.85}
{'loss': 0.0955, 'learning_rate': 3.0371428571428572e-06, 'epoch': 0.85}
{'loss': 0.091, 'learning_rate': 2.9800000000000003e-06, 'epoch': 0.85}
{'loss': 0.112, 'learning_rate': 2.922857142857143e-06, 'epoch': 0.85}
{'loss': 0.109, 'learning_rate': 2.865714285714286e-06, 'epoch': 0.86}
{'loss': 0.0952, 'learning_rate': 2.808571428571429e-06, 'epoch': 0.86}
{'loss': 0.114, 'learning_rate': 2.7514285714285716e-06, 'epoch': 0.86}
{'loss': 0.0942, 'learning_rate': 2.694285714285714e-06, 'epoch': 0.87}
{'loss': 0.089, 'learning_rate': 2.6371428571428577e-06, 'epoch': 0.87}
{'loss': 0.0968, 'learning_rate': 2.5800000000000003e-06, 'epoch': 0.87}
{'loss': 0.1319, 'learning_rate': 2.522857142857143e-06, 'epoch': 0.87}
{'loss': 0.1013, 'learning_rate': 2.465714285714286e-06, 'epoch': 0.88}
{'loss': 0.1024, 'learning_rate': 2.4085714285714286e-06, 'epoch': 0.88}
{'loss': 0.0977, 'learning_rate': 2.3514285714285716e-06, 'epoch': 0.88}
{'loss': 0.1017, 'learning_rate': 2.2942857142857146e-06, 'epoch': 0.89}
{'loss': 0.0969, 'learning_rate': 2.2371428571428573e-06, 'epoch': 0.89}
{'loss': 0.0942, 'learning_rate': 2.1800000000000003e-06, 'epoch': 0.89}
{'loss': 0.1377, 'learning_rate': 2.122857142857143e-06, 'epoch': 0.89}
{'loss': 0.0963, 'learning_rate': 2.065714285714286e-06, 'epoch': 0.9}
{'loss': 0.1063, 'learning_rate': 2.0085714285714286e-06, 'epoch': 0.9}
{'loss': 0.0931, 'learning_rate': 1.9514285714285716e-06, 'epoch': 0.9}
{'loss': 0.0957, 'learning_rate': 1.894857142857143e-06, 'epoch': 0.91}
{'loss': 0.1143, 'learning_rate': 1.8377142857142858e-06, 'epoch': 0.91}
{'loss': 0.0932, 'learning_rate': 1.7805714285714288e-06, 'epoch': 0.91}
{'loss': 0.112, 'learning_rate': 1.7234285714285714e-06, 'epoch': 0.91}
{'loss': 0.1227, 'learning_rate': 1.6662857142857145e-06, 'epoch': 0.92}
{'loss': 0.1072, 'learning_rate': 1.609142857142857e-06, 'epoch': 0.92}
{'loss': 0.0857, 'learning_rate': 1.5520000000000001e-06, 'epoch': 0.92}
{'loss': 0.1156, 'learning_rate': 1.494857142857143e-06, 'epoch': 0.93}
{'loss': 0.1176, 'learning_rate': 1.4377142857142858e-06, 'epoch': 0.93}
{'loss': 0.095, 'learning_rate': 1.3805714285714286e-06, 'epoch': 0.93}
{'loss': 0.0993, 'learning_rate': 1.3234285714285717e-06, 'epoch': 0.93}
{'loss': 0.0819, 'learning_rate': 1.2662857142857143e-06, 'epoch': 0.94}
{'loss': 0.0869, 'learning_rate': 1.2091428571428571e-06, 'epoch': 0.94}
{'loss': 0.0824, 'learning_rate': 1.1520000000000002e-06, 'epoch': 0.94}
{'loss': 0.0858, 'learning_rate': 1.094857142857143e-06, 'epoch': 0.95}
{'loss': 0.1291, 'learning_rate': 1.0377142857142858e-06, 'epoch': 0.95}
{'loss': 0.0924, 'learning_rate': 9.805714285714286e-07, 'epoch': 0.95}
{'loss': 0.0839, 'learning_rate': 9.234285714285715e-07, 'epoch': 0.95}
{'loss': 0.1011, 'learning_rate': 8.662857142857144e-07, 'epoch': 0.96}
{'loss': 0.1129, 'learning_rate': 8.091428571428572e-07, 'epoch': 0.96}
{'loss': 0.1024, 'learning_rate': 7.520000000000001e-07, 'epoch': 0.96}
{'loss': 0.0828, 'learning_rate': 6.94857142857143e-07, 'epoch': 0.97}
{'loss': 0.0948, 'learning_rate': 6.377142857142858e-07, 'epoch': 0.97}
{'loss': 0.1118, 'learning_rate': 5.805714285714287e-07, 'epoch': 0.97}
{'loss': 0.1179, 'learning_rate': 5.234285714285715e-07, 'epoch': 0.97}
{'loss': 0.0934, 'learning_rate': 4.662857142857143e-07, 'epoch': 0.98}
{'loss': 0.0963, 'learning_rate': 4.091428571428572e-07, 'epoch': 0.98}
{'loss': 0.0955, 'learning_rate': 3.5200000000000003e-07, 'epoch': 0.98}
{'loss': 0.1195, 'learning_rate': 2.9485714285714286e-07, 'epoch': 0.99}
{'loss': 0.1092, 'learning_rate': 2.3771428571428574e-07, 'epoch': 0.99}
{'loss': 0.0763, 'learning_rate': 1.805714285714286e-07, 'epoch': 0.99}
{'loss': 0.1017, 'learning_rate': 1.2342857142857145e-07, 'epoch': 0.99}
{'loss': 0.0976, 'learning_rate': 6.62857142857143e-08, 'epoch': 1.0}
{'loss': 0.1271, 'learning_rate': 9.142857142857143e-09, 'epoch': 1.0}
{'eval_loss': 0.10044286400079727, 'eval_accuracy': 0.9693684210526315, 'eval_f1': 0.9693683341639174, 'eval_runtime': 141.8981, 'eval_samples_per_second': 267.798, 'eval_steps_per_second': 16.737, 'epoch': 1.0}
{'train_runtime': 1973.7388, 'train_samples_per_second': 283.725, 'train_steps_per_second': 17.733, 'train_loss': 0.12352775020599366, 'epoch': 1.0}
Fine-tuning finished. Fine-tuning time: 1973.77 seconds.
Evaluating the fine-tuned model on Yelp test set...
Accuracy on Yelp after fine-tuning: 0.9694
F1-score on Yelp after fine-tuning: 0.9694
Inference time (Yelp batch): 0.44 ms/example
GPU Memory at after_yelp_inference:
memory.used [MiB]
2699 MiB

GPU memory consumption: 2.10 GB

Results table for Yelp fine-tuning evaluation:
| Model                          | Accuracy (Yelp) | F1-score (Yelp) | Inference Time (ms) | Memory (GB) | Fine-tuning Time (s) |
|-------------------------------|-----------------|-----------------|---------------------|-------------|----------------------|
| DistilBERT-6-heads (fine-tuned) | 0.9694          | 0.9694          | 0.44          | 2.10       | 1973.77         |
